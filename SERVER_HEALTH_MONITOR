{
  "name": "SERVER_HEALTH_MONITOR",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [{ "field": "minutes", "minutesInterval": 30 }]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [-656, 48],
      "id": "schedule-id",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.0-flash",
          "mode": "list"
        },
        "messages": {
          "values": [{ "content": "=Sei un monitor di salute server. Analizza lo stato JSON: {{ JSON.stringify($json, null, 2) }}" }]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [976, 32],
      "id": "gemini-id",
      "name": "HUMAN_MESSAGE",
      "credentials": {
        "googlePalmApi": {
          "id": "YOUR_GEMINI_CREDENTIAL_ID",
          "name": "Google Gemini Account"
        }
      }
    },
    {
      "parameters": {
        "table": { "__rl": true, "value": "health_logs", "mode": "list" },
        "dataMode": "defineBelow",
        "valuesToSend": {
          "values": [
            { "column": "timestamp", "value": "={{ $json.timestamp }}" },
            { "column": "cpu_pct", "value": "={{ $json.cpu_pct }}" },
            { "column": "overall", "value": "={{ $json.overall }}" }
          ]
        }
      },
      "type": "n8n-nodes-base.mySql",
      "typeVersion": 2.5,
      "position": [656, -224],
      "id": "mysql-id",
      "name": "Insert rows in a table",
      "credentials": {
        "mySql": {
          "id": "YOUR_MYSQL_CREDENTIAL_ID",
          "name": "Jarvis MariaDB"
        }
      }
    },
    {
      "parameters": {
        "chatId": "YOUR_TELEGRAM_CHAT_ID",
        "text": "={{ $node[\"HUMAN_MESSAGE\"].json.text }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1360, 32],
      "id": "tg-alert-id",
      "name": "Send a text message",
      "credentials": {
        "telegramApi": {
          "id": "YOUR_TELEGRAM_CREDENTIAL_ID",
          "name": "Health Monitor Bot"
        }
      }
    }
  ],
  "connections": {
    "Schedule Trigger": { "main": [[{ "node": "CPU", "type": "main", "index": 0 }, { "node": "DISKS", "type": "main", "index": 0 }]] },
    "HUMAN_MESSAGE": { "main": [[{ "node": "Send a text message", "type": "main", "index": 0 }]] }
  },
  "active": false,
  "settings": { "executionOrder": "v1", "timezone": "Europe/Rome" },
  "meta": { "instanceId": "sanitized-id" }
}
